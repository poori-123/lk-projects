"use strict";$(".header").load("./header.html"),$(".footer").load("./footer.html"),function(){bigger({box:".content-main-left-magnifying .xbox",mask:".content-main-left-magnifying .mask",dbox:".content-main-left-magnifying .dbox",img:".content-main-left-magnifying .dbox img"});var i=$(".content-main-left-magnifyingList .scroll"),o=$(".content-main-left-magnifyingList ul"),n=$(".content-main-left-magnifyingList .btnL"),t=$(".content-main-left-magnifyingList .btnR"),e=0;function a(){$(".content-main-left-magnifying .xbox img").attr("src",o.find("li").eq(e).find("img").attr("sign")),$(".content-main-left-magnifying .dbox img").attr("src",o.find("li").eq(e).find("img").attr("sign"))}o.on("mouseover","li",function(){o.find("li").eq(e).removeClass("on"),$(this).addClass("on"),e=$(this).index(),a()}),n.click(function(){if(0===e)return!1;o.find("li").eq(e).removeClass("on"),e--,o.find("li").eq(e).addClass("on"),a(),$lion=o.find(".on");var n,t=$lion[0].offsetWidth+parseInt($lion.css("margin-right"));$lion[0].offsetLeft<i.scrollLeft()&&(n=$lion[0].offsetLeft/t,i.animate({scrollLeft:t*n}))}),t.click(function(){if(e===o.find("li").length-1)return!1;o.find("li").eq(e).removeClass("on"),e++,o.find("li").eq(e).addClass("on"),a(),$lion=o.find(".on");var n,t=$lion[0].offsetWidth+parseInt($lion.css("margin-right"));$lion[0].offsetLeft>=i[0].offsetWidth&&(n=Math.ceil(($lion[0].offsetLeft-i[0].offsetWidth)/t),i.animate({scrollLeft:t*n}))})}(),function(){var n=getQueryString("type"),r=getQueryString("code"),l=null;"mobilephone"==n?($(".content-nav .type").find("a").attr("href","./goodsList.html?type=mobilephone").text("手机"),$(".content-nav .series").find("a").text("华为手机系列")):($(".content-nav .type").find("a").attr("href","./goodsList.html?type=laptop").text("电脑"),$(".content-nav .series").find("a").text("华为笔记本系列")),$.ajax({url:"../data/"+n+".json",type:"get",dataType:"json",success:function(n){l=n[r],$("title").text(l.name),$(".content-nav .name").find("p").text(l.name),$(".content-main-left .xbox").find("img").attr("src",Object.values(l.detailimg)[0]),$(".content-main-left .dbox").find("img").attr("src",Object.values(l.detailimg)[0]);var t=$(".content-main-left-magnifyingList ul"),i="";for(var o in l.detailimg)i+='<li><img src="'.concat(o,'" sign="').concat(l.detailimg[o],'" alt=""></li>');t.append(i),t.find("li").eq(0).addClass("on"),$(".content-main-right h2").attr("gName",l.name),$(".content-main-right .price").find("span").text(l.price);var e="";l.discounts.forEach(function(n){e+="<b>".concat(n,"</b>")}),$(".content-main-right .promotion>div").append("<div>"+e+"</div>"),$(".content-main-right .code strong").text(l.code);var a="";l.color.forEach(function(n){a+='<i><img src="'.concat(l.imgsrc,'" alt="">').concat(n,"</i>")}),$(".content-main-right .choose .color").append(a),$(".content-main-right .choose .color").find("i").eq(0).addClass("on");var c="";l.vision.forEach(function(n){c+="<i>".concat(n,"</i>")}),$(".content-main-right .choose .vision").append(c),$(".content-main-right .choose .vision").find("i").eq(0).addClass("on");var s="";l.combo.forEach(function(n){s+="<i>".concat(n,"</i>")}),$(".content-main-right .choose .combo").append(s),$(".content-main-right .choose .combo").find("i").eq(0).addClass("on"),0==l.stock&&($(".content-main-right .num .addcart").css("display","none"),$(".content-main-right .num .buynow").css("display","none"),$(".content-main-right .num .nomore").css("display","block"),$(".content-main-right .num .add").css({color:"#d6d6d6",cursor:"not-allowed"})),m(),d()}});var t=parseInt($(".content-main-right .num .count").text());function m(){var n=$(".content-main-right .choose .on"),i="";n.each(function(n,t){i+="<em>".concat($(t).text(),"</em>/ ")}),i=i.slice(0,i.length-2),$(".content-main-right .choosed div").html(i)}function d(){var n=$(".content-main-right h2").attr("gName")+" "+$(".content-main-right .choose .vision .on").text()+" ("+$(".content-main-right .choose .color .on").text()+") ("+$(".content-main-right .choose .combo .on").text()+")";$(".content-main-right h2").text(n)}$(".content-main-right .num .add").click(function(){return"not-allowed"!==$(this).css("cursor")&&(1==t&&$(this).siblings(".mius").css({color:"#333",cursor:"pointer"}),void $(this).siblings(".count").text(++t))}),$(".content-main-right .num .mius").click(function(){return 1!=t&&($(this).siblings(".count").text(--t),void(1==t&&$(this).css({color:"#d6d6d6",cursor:"not-allowed"})))}),$(".content-main-right .choose").on("click","i",function(){return!$(this).hasClass("on")&&(($(this).parent().hasClass("vision")||$(this).parent().hasClass("combo"))&&(n=parseInt($(".content-main-right .price span").text()),n+=1e3*($(this).index()-$(this).siblings(".on").index()),$(".content-main-right .price span").text(n)),$(this).siblings().removeClass("on"),$(this).addClass("on"),m(),void d());var n})}(),function(){JSON.parse(localStorage.getItem("user"));var l=$(".cartMask");$(".content-main .addcart").click(function(){if(!getCookie("username"))return l.css("display","block"),l.find("p").text("请登录后重试！"),!1;var n=getCookie("username"),t=$(".content-main-right .code strong").text(),i=$(".content-main .num .count").text(),o=t+$(".content-main .choose .color .on").index()+$(".content-main .choose .vision .on").index()+$(".content-main .choose .combo .on").index(),e=$(".content-main .price span").text(),a=$(".content-main-right h2").text(),c=$(".content-main .choose .color .on img").attr("src"),s=JSON.parse(localStorage.getItem(n+"goods"))||{};s[o]?s[o].num=parseInt(s[o].num)+parseInt(i):s[o]={goodsname:a,price:e,goodssrc:c,num:i};var r=JSON.stringify(s);localStorage.setItem(n+"goods",r),l.css("display","block"),l.find("p").text(a+"  成功加入购物车！"),l.css("height",document.documentElement.offsetHeight)}),l.find("i").click(function(){l.css("display","none"),location.reload()}),l.find("span").click(function(){l.css("display","none"),location.reload()})}();