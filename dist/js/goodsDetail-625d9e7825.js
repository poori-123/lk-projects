"use strict";$(".header").load("./header.html"),$(".footer").load("./footer.html"),function(){bigger({box:".content-main-left-magnifying .xbox",mask:".content-main-left-magnifying .mask",dbox:".content-main-left-magnifying .dbox",img:".content-main-left-magnifying .dbox img"});var o=$(".content-main-left-magnifyingList .scroll"),e=$(".content-main-left-magnifyingList ul"),n=$(".content-main-left-magnifyingList .btnL"),t=$(".content-main-left-magnifyingList .btnR"),a=0;function c(){$(".content-main-left-magnifying .xbox img").attr("src",e.find("li").eq(a).find("img").attr("sign")),$(".content-main-left-magnifying .dbox img").attr("src",e.find("li").eq(a).find("img").attr("sign"))}e.on("mouseover","li",function(){e.find("li").eq(a).removeClass("on"),$(this).addClass("on"),a=$(this).index(),c()}),n.click(function(){if(0===a)return!1;e.find("li").eq(a).removeClass("on"),a--,e.find("li").eq(a).addClass("on"),c();var n,t=e.find(".on"),i=t[0].offsetWidth+parseInt(t.css("margin-right"));t[0].offsetLeft<o.scrollLeft()&&(n=t[0].offsetLeft/i,o.animate({scrollLeft:i*n}))}),t.click(function(){if(a===e.find("li").length-1)return!1;e.find("li").eq(a).removeClass("on"),a++,e.find("li").eq(a).addClass("on"),c();var n,t=e.find(".on"),i=t[0].offsetWidth+parseInt(t.css("margin-right"));t[0].offsetLeft>=o[0].offsetWidth&&(n=Math.ceil((t[0].offsetLeft-o[0].offsetWidth)/i),o.animate({scrollLeft:i*n}))})}(),function(){var n=getQueryString("type"),r=getQueryString("code"),m=null;"mobilephone"==n?($(".content-nav .type").find("a").attr("href","./goodsList.html?type=mobilephone").text("手机"),$(".content-nav .series").find("a").text("华为手机系列")):($(".content-nav .type").find("a").attr("href","./goodsList.html?type=laptop").text("电脑"),$(".content-nav .series").find("a").text("华为笔记本系列")),$.ajax({url:"../data/"+n+".json",type:"get",dataType:"json",success:function(n){m=n[r],$("title").text(m.name),$(".content-nav .name").find("p").text(m.name),$(".content-main-left .xbox").find("img").attr("src",Object.values(m.detailimg)[0]),$(".content-main-left .dbox").find("img").attr("src",Object.values(m.detailimg)[0]);var t=$(".content-main-left-magnifyingList ul"),i="";for(var o in m.detailimg)i+='<li><img src="'.concat(o,'" sign="').concat(m.detailimg[o],'" alt=""></li>');t.append(i),t.find("li").eq(0).addClass("on"),$(".content-main-right h2").attr("gName",m.name),$(".content-main-right .price").find("span").text(m.price);var e="";m.discounts.forEach(function(n){e+="<b>".concat(n,"</b>")}),$(".content-main-right .promotion>div").append("<div>"+e+"</div>"),$(".content-main-right .code strong").text(m.code);var a="";m.color.forEach(function(n){a+='<i><img src="'.concat(m.imgsrc,'" alt="">').concat(n,"</i>")}),$(".content-main-right .choose .color").append(a),$(".content-main-right .choose .color").find("i").eq(0).addClass("on");var c="";m.vision.forEach(function(n){c+="<i>".concat(n,"</i>")}),$(".content-main-right .choose .vision").append(c),$(".content-main-right .choose .vision").find("i").eq(0).addClass("on");var s="";m.combo.forEach(function(n){s+="<i>".concat(n,"</i>")}),$(".content-main-right .choose .combo").append(s),$(".content-main-right .choose .combo").find("i").eq(0).addClass("on"),0==m.stock&&($(".content-main-right .num .addcart").css("display","none"),$(".content-main-right .num .buynow").css("display","none"),$(".content-main-right .num .nomore").css("display","block"),$(".content-main-right .num .add").css({color:"#d6d6d6",cursor:"not-allowed"})),l(),d()}});var t=parseInt($(".content-main-right .num .count").text());function l(){var n=$(".content-main-right .choose .on"),i="";n.each(function(n,t){i+="<em>".concat($(t).text(),"</em>/ ")}),i=i.slice(0,i.length-2),$(".content-main-right .choosed div").html(i)}function d(){var n=$(".content-main-right h2").attr("gName")+" "+$(".content-main-right .choose .vision .on").text()+" ("+$(".content-main-right .choose .color .on").text()+") ("+$(".content-main-right .choose .combo .on").text()+")";$(".content-main-right h2").text(n)}$(".content-main-right .num .add").click(function(){return"not-allowed"!==$(this).css("cursor")&&(1==t&&$(this).siblings(".mius").css({color:"#333",cursor:"pointer"}),void $(this).siblings(".count").text(++t))}),$(".content-main-right .num .mius").click(function(){return 1!=t&&($(this).siblings(".count").text(--t),void(1==t&&$(this).css({color:"#d6d6d6",cursor:"not-allowed"})))}),$(".content-main-right .choose").on("click","i",function(){return!$(this).hasClass("on")&&(($(this).parent().hasClass("vision")||$(this).parent().hasClass("combo"))&&(n=parseInt($(".content-main-right .price span").text()),n+=1e3*($(this).index()-$(this).siblings(".on").index()),$(".content-main-right .price span").text(n)),$(this).siblings().removeClass("on"),$(this).addClass("on"),l(),void d());var n})}(),function(){JSON.parse(localStorage.getItem("user"));var m=$(".cartMask");$(".content-main .addcart").click(function(){if(!getCookie("username"))return m.css("display","block"),m.find("p").text("请登录后重试！"),!1;var n=getCookie("username"),t=$(".content-main-right .code strong").text(),i=$(".content-main .num .count").text(),o=t+$(".content-main .choose .color .on").index()+$(".content-main .choose .vision .on").index()+$(".content-main .choose .combo .on").index(),e=$(".content-main .price span").text(),a=$(".content-main-right h2").text(),c=$(".content-main .choose .color .on img").attr("src"),s=JSON.parse(localStorage.getItem(n+"goods"))||{};s[o]?s[o].num=parseInt(s[o].num)+parseInt(i):s[o]={goodsname:a,price:e,goodssrc:c,num:i};var r=JSON.stringify(s);localStorage.setItem(n+"goods",r),m.css("display","block"),m.find("p").text(a+"  成功加入购物车！"),m.css("height",document.documentElement.offsetHeight)}),m.find("i").click(function(){m.css("display","none"),location.reload()}),m.find("span").click(function(){m.css("display","none"),location.reload()})}();